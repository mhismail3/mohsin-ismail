/* =============================================================================
   PAGE TRANSITIONS - Staggered Cascade Animation
   Elegant sequential fade-in for page elements
   ============================================================================= */

/* ─────────────────────────────────────────────────────────────────────────────
   TRANSITION CONTAINER
   
   The wrapper itself has NO animation to avoid breaking the fixed header.
   Transform on ancestors breaks `position: fixed` descendants.
   Instead, we animate individual sections and content elements.
   
   FOUC Prevention:
   - .page-transition-init: Initial state, content hidden, waiting for mount
   - .page-transition-ready: Animations trigger, content fades in
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition {
  /* No animation on container - children animate individually */
}

/* ─────────────────────────────────────────────────────────────────────────────
   HEADER COORDINATION
   
   The header participates in page transitions to prevent flicker:
   - During init phase: header is hidden (opacity 0)
   - During ready phase: header fades in with content (first element to animate)
   
   This ensures the header doesn't appear, then disappear (due to scroll-collapse
   triggering), then reappear as the page scrolls to top.
   
   The .navigating class on the header indicates scroll behavior is suspended,
   coordinated via PageTransitionContext.
   ───────────────────────────────────────────────────────────────────────────── */

/* Header hidden during init phase */
.page-transition-init .top-bar {
  opacity: 0;
}

/* Header fades in first during ready phase */
.page-transition-ready .top-bar {
  animation: simpleFadeIn 0.24s ease-out both;
  animation-delay: 0s;
}

/* Ensure header doesn't get the staggerFadeIn (no transform, just fade) */
.page-transition-ready .top-bar.navigating {
  /* While navigating, use simple fade only - no transform */
  animation: simpleFadeIn 0.24s ease-out both;
  animation-delay: 0s;
}

/* ─────────────────────────────────────────────────────────────────────────────
   INITIAL STATE (Before animations are ready)
   
   Hide all animatable content immediately. This prevents the flash where
   content briefly appears before animations kick in.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-init .frame > section,
.page-transition-init .frame > article,
.page-transition-init .post-list > article,
.page-transition-init .moodboard-column,
.page-transition-init .moodboard-column .project-card,
.page-transition-init .about-content > *,
.page-transition-init .featured-project-card,
.page-transition-init .post-page .post-page-head,
.page-transition-init .post-page .post-body,
.page-transition-init .post-page .post-tags,
.page-transition-init .post-page .post-footer,
.page-transition-init .project-page .project-hero,
.page-transition-init .project-page .project-content,
.page-transition-init .panel-head,
.page-transition-init .filter-row .tag-cloud .pill {
  opacity: 0;
}

/* ─────────────────────────────────────────────────────────────────────────────
   STAGGER ANIMATION KEYFRAME
   
   Subtle fade + lift effect. Transform is safe here because we apply it
   to sibling elements of the header, not ancestors.
   ───────────────────────────────────────────────────────────────────────────── */

@keyframes staggerFadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Simple fade for elements where transform might cause issues */
@keyframes simpleFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ─────────────────────────────────────────────────────────────────────────────
   SECTION-LEVEL STAGGER
   
   Each major section/panel fades in sequentially.
   Using nth-of-type(section) to skip the fixed header element.
   Animations only trigger when .page-transition-ready is applied.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .frame > section,
.page-transition-ready .frame > article {
  animation: staggerFadeIn 0.32s ease-in-out both;
}

/* Stagger timing for sections (70ms apart) */
.page-transition-ready .frame > section:nth-of-type(1),
.page-transition-ready .frame > article:nth-of-type(1) { animation-delay: 0.03s; }

.page-transition-ready .frame > section:nth-of-type(2),
.page-transition-ready .frame > article:nth-of-type(2) { animation-delay: 0.1s; }

.page-transition-ready .frame > section:nth-of-type(3),
.page-transition-ready .frame > article:nth-of-type(3) { animation-delay: 0.17s; }

.page-transition-ready .frame > section:nth-of-type(4),
.page-transition-ready .frame > article:nth-of-type(4) { animation-delay: 0.24s; }

.page-transition-ready .frame > section:nth-of-type(5),
.page-transition-ready .frame > article:nth-of-type(5) { animation-delay: 0.31s; }

/* ─────────────────────────────────────────────────────────────────────────────
   POST CARDS STAGGER
   
   Individual blog post cards animate in sequence within the post list.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .post-list > article {
  animation: staggerFadeIn 0.28s ease-in-out both;
}

/* Stagger timing for post cards (45ms apart, starting after section delay) */
.page-transition-ready .post-list > article:nth-child(1) { animation-delay: 0.06s; }
.page-transition-ready .post-list > article:nth-child(2) { animation-delay: 0.11s; }
.page-transition-ready .post-list > article:nth-child(3) { animation-delay: 0.16s; }
.page-transition-ready .post-list > article:nth-child(4) { animation-delay: 0.20s; }
.page-transition-ready .post-list > article:nth-child(5) { animation-delay: 0.24s; }
.page-transition-ready .post-list > article:nth-child(6) { animation-delay: 0.28s; }
.page-transition-ready .post-list > article:nth-child(7) { animation-delay: 0.32s; }
.page-transition-ready .post-list > article:nth-child(8) { animation-delay: 0.35s; }
.page-transition-ready .post-list > article:nth-child(9) { animation-delay: 0.38s; }
.page-transition-ready .post-list > article:nth-child(10) { animation-delay: 0.41s; }

/* ─────────────────────────────────────────────────────────────────────────────
   PORTFOLIO MOODBOARD STAGGER
   
   Moodboard columns animate in sequence (left to right).
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .moodboard-column {
  animation: staggerFadeIn 0.32s ease-in-out both;
}

.page-transition-ready .moodboard-column:nth-child(1) { animation-delay: 0.06s; }
.page-transition-ready .moodboard-column:nth-child(2) { animation-delay: 0.13s; }
.page-transition-ready .moodboard-column:nth-child(3) { animation-delay: 0.20s; }

/* Project cards within moodboard columns */
.page-transition-ready .moodboard-column .project-card {
  animation: staggerFadeIn 0.28s ease-in-out both;
}

.page-transition-ready .moodboard-column:nth-child(1) .project-card:nth-child(1) { animation-delay: 0.1s; }
.page-transition-ready .moodboard-column:nth-child(1) .project-card:nth-child(2) { animation-delay: 0.18s; }
.page-transition-ready .moodboard-column:nth-child(1) .project-card:nth-child(3) { animation-delay: 0.26s; }

.page-transition-ready .moodboard-column:nth-child(2) .project-card:nth-child(1) { animation-delay: 0.14s; }
.page-transition-ready .moodboard-column:nth-child(2) .project-card:nth-child(2) { animation-delay: 0.22s; }
.page-transition-ready .moodboard-column:nth-child(2) .project-card:nth-child(3) { animation-delay: 0.30s; }

.page-transition-ready .moodboard-column:nth-child(3) .project-card:nth-child(1) { animation-delay: 0.18s; }
.page-transition-ready .moodboard-column:nth-child(3) .project-card:nth-child(2) { animation-delay: 0.26s; }
.page-transition-ready .moodboard-column:nth-child(3) .project-card:nth-child(3) { animation-delay: 0.34s; }

/* ─────────────────────────────────────────────────────────────────────────────
   ABOUT PAGE CONTENT STAGGER
   
   About content paragraphs and gallery animate in sequence.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .about-content > * {
  animation: staggerFadeIn 0.28s ease-in-out both;
}

.page-transition-ready .about-content > *:nth-child(1) { animation-delay: 0.06s; }
.page-transition-ready .about-content > *:nth-child(2) { animation-delay: 0.12s; }
.page-transition-ready .about-content > *:nth-child(3) { animation-delay: 0.18s; }
.page-transition-ready .about-content > *:nth-child(4) { animation-delay: 0.24s; }
.page-transition-ready .about-content > *:nth-child(5) { animation-delay: 0.30s; }

/* ─────────────────────────────────────────────────────────────────────────────
   FEATURED PROJECT (Home Page)
   
   The featured project card on the home page.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .featured-project-card {
  animation: staggerFadeIn 0.32s ease-in-out both;
  animation-delay: 0.12s;
}

/* ─────────────────────────────────────────────────────────────────────────────
   POST PAGE CONTENT
   
   The article content on individual post pages.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .post-page .post-page-head {
  animation: staggerFadeIn 0.28s ease-in-out both;
  animation-delay: 0.04s;
}

.page-transition-ready .post-page .post-body {
  animation: staggerFadeIn 0.32s ease-in-out both;
  animation-delay: 0.12s;
}

.page-transition-ready .post-page .post-tags {
  animation: staggerFadeIn 0.28s ease-in-out both;
  animation-delay: 0.2s;
}

.page-transition-ready .post-page .post-footer {
  animation: staggerFadeIn 0.28s ease-in-out both;
  animation-delay: 0.26s;
}

/* ─────────────────────────────────────────────────────────────────────────────
   PROJECT PAGE CONTENT
   
   The project detail page elements.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .project-page .project-hero {
  animation: staggerFadeIn 0.32s ease-in-out both;
  animation-delay: 0.04s;
}

.page-transition-ready .project-page .project-content {
  animation: staggerFadeIn 0.32s ease-in-out both;
  animation-delay: 0.12s;
}

/* ─────────────────────────────────────────────────────────────────────────────
   PANEL HEADERS
   
   Panel headers (eyebrow + title) get a subtle early entrance.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .panel-head {
  animation: simpleFadeIn 0.25s ease-in-out both;
  animation-delay: 0.02s;
}

/* ─────────────────────────────────────────────────────────────────────────────
   TAG CLOUD STAGGER
   
   Filter tags animate with slight stagger.
   ───────────────────────────────────────────────────────────────────────────── */

.page-transition-ready .filter-row .tag-cloud .pill {
  animation: simpleFadeIn 0.22s ease-in-out both;
}

.page-transition-ready .filter-row .tag-cloud .pill:nth-child(1) { animation-delay: 0.22s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(2) { animation-delay: 0.24s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(3) { animation-delay: 0.26s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(4) { animation-delay: 0.28s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(5) { animation-delay: 0.30s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(6) { animation-delay: 0.32s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(7) { animation-delay: 0.34s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(8) { animation-delay: 0.36s; }
.page-transition-ready .filter-row .tag-cloud .pill:nth-child(n+9) { animation-delay: 0.38s; }

/* ─────────────────────────────────────────────────────────────────────────────
   REDUCED MOTION
   
   Respect user preferences - simple fade only, no transforms.
   ───────────────────────────────────────────────────────────────────────────── */

@media (prefers-reduced-motion: reduce) {
  .page-transition-ready .frame > section,
  .page-transition-ready .frame > article,
  .page-transition-ready .post-list > article,
  .page-transition-ready .moodboard-column,
  .page-transition-ready .moodboard-column .project-card,
  .page-transition-ready .about-content > *,
  .page-transition-ready .featured-project-card,
  .page-transition-ready .post-page .post-page-head,
  .page-transition-ready .post-page .post-body,
  .page-transition-ready .post-page .post-tags,
  .page-transition-ready .post-page .post-footer,
  .page-transition-ready .project-page .project-hero,
  .page-transition-ready .project-page .project-content,
  .page-transition-ready .panel-head,
  .page-transition-ready .filter-row .tag-cloud .pill {
    animation: simpleFadeIn 0.2s ease both;
    animation-delay: 0s;
  }
}
